import{d as q,r as D,n as z,E as s,o as p,c as P,b as l,w as e,e as u,f as a,u as m,t as c,q as v,F as G,G as K,h as f,T as C,K as Q,Q as j,_ as H}from"./index-Ba8PhKSB.js";import{u as J}from"./user-CswI-_sj.js";import{a as O}from"./address-DrSDh0H_.js";const R={class:"profile-container"},W={class:"card-header"},X={class:"avatar-section"},Y={class:"card-header"},Z={class:"header-actions"},ee={class:"address-actions"},te=q({__name:"profile",setup(re){const d=J(),h=D(),k=D([]);z(async()=>{try{await Promise.all([d.fetchUserProfile(),b()])}catch{s.error("获取信息失败")}});const b=async()=>{try{const r=await O.getAddressList();k.value=r.data.data}catch(r){console.error("获取地址列表失败:",r),s.error("获取地址列表失败")}},B=async()=>{try{await b(),s.success("刷新地址列表成功")}catch{s.error("刷新地址列表失败")}},T=async()=>{try{await d.fetchUserProfile(),s.success("刷新成功")}catch{s.error("刷新失败")}},E=()=>{var r;(r=h.value)==null||r.click()},N=async r=>{var y;const o=r.target,i=(y=o.files)==null?void 0:y[0];if(i)try{await d.uploadAvatar(i),s.success("头像上传成功")}catch(n){s.error(n.message||"头像上传失败")}finally{o.value=""}},g=r=>r?new Date(r).toLocaleString():"-",U=r=>`${r.province}${r.city}${r.district} ${r.detailAddress} ${r.isDefault?"(默认)":""}`,A=()=>{s.info("添加地址功能开发中...")},I=r=>{s.info("编辑地址功能开发中...")},M=r=>{j.confirm("确定要删除这个地址吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{s.info("删除地址功能开发中...")}).catch(()=>{})},S=r=>{s.info("设置默认地址功能开发中...")};return(r,o)=>{const i=f("el-button"),y=f("el-avatar"),n=f("el-descriptions-item"),$=f("el-descriptions"),w=f("el-card"),V=f("el-empty"),F=f("el-collapse-item"),L=f("el-collapse");return p(),P("div",R,[l(w,{class:"profile-card"},{header:e(()=>[u("div",W,[o[1]||(o[1]=u("span",null,"个人信息",-1)),l(i,{type:"primary",onClick:T},{default:e(()=>o[0]||(o[0]=[a("刷新")])),_:1})])]),default:e(()=>[u("div",X,[l(y,{size:100,src:m(d).avatarUrl,onError:()=>!0},{default:e(()=>{var t,_,x;return[a(c((x=(_=(t=m(d).userProfile)==null?void 0:t.name)==null?void 0:_.charAt(0))==null?void 0:x.toUpperCase()),1)]}),_:1},8,["src"]),l(i,{type:"primary",onClick:E,class:"upload-btn"},{default:e(()=>o[2]||(o[2]=[a(" 更换头像 ")])),_:1})]),l($,{column:1,border:""},{default:e(()=>[l(n,{label:"用户ID"},{default:e(()=>{var t;return[a(c((t=m(d).userProfile)==null?void 0:t.id),1)]}),_:1}),l(n,{label:"用户名"},{default:e(()=>{var t;return[a(c((t=m(d).userProfile)==null?void 0:t.name),1)]}),_:1}),l(n,{label:"邮箱"},{default:e(()=>{var t;return[a(c((t=m(d).userProfile)==null?void 0:t.email),1)]}),_:1})]),_:1})]),_:1}),l(w,null,{header:e(()=>[u("div",Y,[o[5]||(o[5]=u("span",null,"收货地址",-1)),u("div",Z,[l(i,{type:"primary",onClick:A},{default:e(()=>o[3]||(o[3]=[a("添加地址")])),_:1}),l(i,{type:"primary",onClick:B},{default:e(()=>o[4]||(o[4]=[a("刷新")])),_:1})])])]),default:e(()=>[k.value.length?(p(),v(L,{key:1},{default:e(()=>[(p(!0),P(G,null,K(k.value,t=>(p(),v(F,{key:t.id,title:U(t)},{extra:e(()=>[u("div",ee,[t.isDefault?Q("",!0):(p(),v(i,{key:0,type:"primary",link:"",onClick:C(_=>S(t),["stop"])},{default:e(()=>o[7]||(o[7]=[a(" 设为默认 ")])),_:2},1032,["onClick"])),l(i,{type:"primary",link:"",onClick:C(_=>I(t),["stop"])},{default:e(()=>o[8]||(o[8]=[a(" 编辑 ")])),_:2},1032,["onClick"]),l(i,{type:"danger",link:"",onClick:C(_=>M(t),["stop"])},{default:e(()=>o[9]||(o[9]=[a(" 删除 ")])),_:2},1032,["onClick"])])]),default:e(()=>[l($,{column:1,border:""},{default:e(()=>[l(n,{label:"收货人"},{default:e(()=>[a(c(t.receiverName),1)]),_:2},1024),l(n,{label:"联系电话"},{default:e(()=>[a(c(t.receiverPhone),1)]),_:2},1024),l(n,{label:"所在地区"},{default:e(()=>[a(c(`${t.province}${t.city}${t.district}`),1)]),_:2},1024),l(n,{label:"详细地址"},{default:e(()=>[a(c(t.detailAddress),1)]),_:2},1024),l(n,{label:"是否默认"},{default:e(()=>[a(c(t.isDefault?"是":"否"),1)]),_:2},1024),l(n,{label:"创建时间"},{default:e(()=>[a(c(g(t.createTime)),1)]),_:2},1024),l(n,{label:"更新时间"},{default:e(()=>[a(c(g(t.updateTime)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1})):(p(),v(V,{key:0,description:"暂无收货地址"},{default:e(()=>[l(i,{type:"primary",onClick:A},{default:e(()=>o[6]||(o[6]=[a("添加收货地址")])),_:1})]),_:1}))]),_:1}),u("input",{type:"file",ref_key:"fileInput",ref:h,style:{display:"none"},accept:"image/*",onChange:N},null,544)])}}}),ne=H(te,[["__scopeId","data-v-9c8988e3"]]);export{ne as default};
